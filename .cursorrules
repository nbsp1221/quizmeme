---
description: "Repoâ€‘wide guidelines for the Dailyâ€‘Quizâ€‘&â€‘Memeâ€‘Generator Preact project"
alwaysApply: true
---

# ğŸ—‚ï¸  Project Context
You are working on a 100Â % frontâ€‘end, adâ€‘monetised PWA called **Daily Quiz & Meme Generator**.  
Stack: **PreactÂ +Â TypeScriptÂ +Â ViteÂ +Â TailwindCSSÂ +Â Workbox SW**.  
All business logic, state, and data persist clientâ€‘side (localStorage / IndexedDB).  
Code must remain treeâ€‘shakable and bundle â‰¤Â 150Â kBÂ gzipped for the critical path.

# ğŸ¨  Git Commit Convention â€“Â Gitmoji
Always suggest commit messages in the format  
`<emoji> (<scope>): <imperativeâ€‘presentâ€‘tense message>`  
where `<emoji>` is one of the official Gitmoji shortâ€‘codes (e.g. `:sparkles:`),  
`<scope>` maps to a folder or feature (e.g. `quiz`, `ads`, `pwa`),  
and the message is â‰¤Â 72Â characters, capitalised, no fullâ€‘stop.

Common pairs (add more if needed):
- `:sparkles:`Â (**feature**) â€“ new quiz type, streak logic, meme filter
- `:bug:`Â (**fix**) â€“ runtime error, rendering glitch
- `:art:`Â (**style**) â€“ CSS polish or refactor without behaviour change
- `:zap:`Â (**perf**) â€“ lazyâ€‘load, bundle reduction
- `:rocket:`Â (**deploy**) â€“ CI, Netlify config
- `:white_check_mark:`Â (**test**) â€“ add/update tests
- `:rotating_light:`Â (**lint**) â€“ ESLint/TSC warnings
- `:fire:`Â (**clean**) â€“ remove dead code/assets

# ğŸ› ï¸  Coding Standards
- Prefer **functional components**; hooks must start withÂ `use`.  
- No implicitÂ `any`; enableÂ `strict`Â andÂ `noUncheckedIndexedAccess` inÂ `tsconfig.json`.  
- CSS via Tailwind utility classes only; never inline style blobs.  
- Split UI into `components/`, hooks into `hooks/`, ads into `ads/`.  
- Export single default component perÂ `.tsx` unless file is a hook.

# ğŸ“¦  Build & Performance
- Do not import the full `preact/compat`; import named exports.  
- Inline critical CSS with Viteâ€™s `<style module>` then purge unused Tailwind classes.  
- Target <2Â s FirstÂ ContentfulÂ Paint on MotoÂ G4.  
- RunÂ `npm run build --mode production` before suggesting deploy steps.

# ğŸ“±  PWA & Offline
- Register Workbox SW from `sw.ts`; cache quiz JSON & images with a staleâ€‘whileâ€‘revalidate strategy.  
- Show an â€œOfflineâ€ toast if network fails and cached response absent.  
- Always include `display: 'standalone'`, `start_url`Â =Â `/` inÂ `manifest.webmanifest`.

# ğŸ’°  Ads & Policy Guardrails
- Initialise AdSense script once per session; avoid multiple `googletag.enableServices()` calls.  
- Interstitial (`GAME_MANUAL_INTERSTITIAL`) triggers only **after** quiz completion.  
- Rewarded video optional; if skipped, fall back to Taboola native feed.  
- Never autoâ€‘play audio; comply with Google Ad Manager viewability (â‰¥50Â % pixels, â‰¥1Â s).

# âœ…  Testing & CI
- Generate unit tests withÂ Vitest; maintain coverage â‰¥Â 80Â % in `src/`.  
- Lint & typeâ€‘check must pass before proposing CI merge.  
- Use Lighthouse CI in GitHub Actions to assert perf budgets.

# ğŸ—£ï¸  Response Language & Tone
- Chat responses default to concise English technical prose.  
- Commit messages: English only, emoji first.  
- Inline comments may be Korean if describing userâ€‘visible copy.

# ğŸ§©  Template Shortcuts
@component-template.tsx   # standard functional component skeleton  
@quiz-schema.json         # canonical quiz JSON schema  
@result-card-template.tsx # meme card HTMLâ€‘toâ€‘canvas snippet
